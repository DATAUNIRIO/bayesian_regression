---
title: "movie_prediction"
output: 
  html_document: 
    fig_height: 4
    highlight: pygments
    theme: spacelab
---
## Setup
### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(dplyr)
library(statsr)
library(grid)
library(gridExtra)
library(tidyverse)
library(broom)
library(plyr)
```

### Load data

```{r load-data}
load()
```


```{r release years}
min(movies$thtr_rel_year)
max(movies$thtr_rel_year)
```

* * *
## Data

In the `movies` dataset, there is 651 **randomly sampled** movies which were released in United States movie theater in the period of 1970-2014. The data was obtained from [Rotten Tomatoes](https://www.rottentomatoes.com/) and [IMDB](https://www.imdb.com/). The dataset contains 32 features of each movie, including genre, MPAA rating, production studio, and whether they recieved Oscar nominations.

Even though there is no detailed information about the exact sampling methods used, the movies included in this dataset were randomly sampled from the above two mentioned sources and no bias were created by the sampling method so we can assume that the results obtained can be **generalized to all U.S movies released between 1970 and 2014**. On the other hand, because this is an observational study, **the relationships that could be find from this data indicate association, but _not causation_**

* * *




* * *
## Data wrangling  
    
In order to develop the Bayesian regression model to predict `audience_score` from the explanatory variables, we will use the function `mutate` to create the new variables as follows:

  * `feature_film`: with two levels:
    + 'yes': if `title_type` is 'Feature Film'
    + 'no': otherwise
    
```{r feature}
movies <- movies%>%
        mutate(feature_film = factor(ifelse(title_type == 'Feature Film', 'yes', 'no')))
```

  * `drama`: with two levels:
    + 'yes': if `genre` is 'Drama'
    + 'no': otherwise

```{r drama}
movies <- movies%>%
        mutate(drama = factor(ifelse(genre == 'Drama', 'yes', 'no')))
```

  * `mpaa_rating_R`: with two levels:
    + 'yes': if `mpaa_rating` is 'R'
    + 'no': otherwise

```{r mpaa}
movies <- movies%>%
        mutate(mpaa_rating_R = factor(ifelse(mpaa_rating == 'R', 'yes', 'no')))
```

  * `oscar_season`: with two levels:
    + 'yes': if `thtr_rel_month` is 'November' or 'October' or 'December'
    + 'no': otherwise

```{r oscar}
movies <- movies%>%
        mutate(oscar_season = factor(ifelse(thtr_rel_month == 10|
                                       thtr_rel_month == 11|
                                       thtr_rel_month == 12,
                                                            'yes', 'no')))
```

  * `summer_season`: with two levels:
    + 'yes': if `thtr_rel_month` is 'May' or 'June' or 'July' or 'August'
    + 'no': otherwise

```{r summer}
movies <- movies%>%
        mutate(summer_season = factor(ifelse(thtr_rel_month == 5|
                                       thtr_rel_month == 6|
                                       thtr_rel_month == 7|
                                       thtr_rel_month == 8,
                                                            'yes', 'no')))
```

* * * 
## Exploratory data analysis
First of all, we will check whether `audience_score` and `imdb_rating` show a correlation between them. For doing this, we will plot both variables in a scatter plot: 

```{r fig.width=5, fig.height=3}
ggplot(movies, aes(x=audience_score, y=imdb_rating))+
  theme_minimal()+
  geom_point()+
  geom_smooth()+
  labs(x = "Score in Rotten Tomatoes", y = "Rating in Imdb")
   
```


